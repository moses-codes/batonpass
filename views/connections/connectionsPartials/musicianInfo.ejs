<% let connectedPosts = posts.filter( el => el.interestedUsers.indexOf(connection._id) > -1).filter(post => `${post.user}` == `${currUser._id}`)  %>

<% let summaryFormatted = connection.summary.filter(el => el !== '').join(' | ') %>
<div class="w-3/4 pt-20">
</div>
<div class="w-3/4 bg-base-100 rounded-md shadow-xl xl:flex block mx-auto mt-5 pb-5">
<div class="h-auto p-5">
   <div class="w-48 rounded mb-5 mx-auto">
    <img class="mb-3 w-48 h-48 rounded-full" src="<%= connection.image %>"  alt="profile picture"/>
   </div>
   <% if (connectedPosts.length) {%>
   <div class="badge badge-outline badge-accent mb-3"><%= `${connection.givenName}` %> is interested in these listings! </div>
   <% }%>
   <ul class="w-96">
    <% connectedPosts.forEach( post => { %>
      <li class="mb-5">
        <div class="flex justify-between">
          <h3 class="text-lg col-8"><%= post.title %></h3>
          <h4 class="col-3 text-sm"><%= post.startDate.toLocaleDateString() %></h4>
        </div>
      <hr class="mb-2">
      <h3 class="text-gray-500"><%= post.description %></h3>
      </li> 
    <% }) %>
  </ul>
</div>

<div class="m-10">
  <div class="m-10">
    <h2 class="card-title text-3xl"><%= `${connection.givenName} ${connection.surName}` %></h2>
    <p class="text-md text-gray-500 mb-2"><%= summaryFormatted %></p>
    <p class="my-3 text-lg"><%= `${connection.city}, ${connection.loc_state}` %></p>
    <p class="my-3 text-md w-3/4"><%= connection.bio %></p>
    <p class="text-md text-gray-500 mt-5 mb-2">Contact</p>
    <hr class="w-1/4 mb-3">
    <p class="text-lg">26985 Brighton Lane,</p>
    <p class="text-lg"><%= `${connection.city}, ${connection.loc_state}` %> 91200</p>
    <p class=" my-3"><a class="text-lg" href="mailto:<%= `${connection.email}` %>"><%= `${connection.email}` %></a></p>
    <p>XXX-XXXX-XXX</p>
  </div>
</div>
</div>